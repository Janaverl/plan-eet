{% extends 'boxes.html.twig' %}

{% block body %}
    <div class="contentwrapper">

    {# title #}
    {% if mode == "add" %}
        <h1>voeg een recept toe</h1>
    {% elseif mode == "update" %}
        <h1>pas de informatie van het recept {{value.name}} aan</h1></p>
    {% endif %}
    
    {# all cards #}
    <div class="cardwrapper">
        {% if mode == "add" %}
            <div class="w3-card step">
                <h3>Deze waarden zitten al in de database:</h3>
                <input type="text" class="w3-input filterBy" placeholder="zoek een recept ...">
                <div class="scrollbox">
                    <ul class="w3-ul">
                        {% for value in values %}
                            <li>{{value.name}}</li>
                        {% endfor %}
                    </ul>
                </div>
            </div>
        {% endif %}

        <div class="w3-card step generalInformation">
            <h3>algemene info</h3>

            <input type="text" id="name" name="name" class="w3-input" placeholder=
            {% if mode == "update" %}
                "recept: {{value.name}}" disabled
            {% else %}
                "naam recept"
            {% endif %}>


            <input type="text" id="suggestion" name="suggestion" class="w3-input" placeholder="recept tip (optioneel)"
            {% if mode == "update" %}
                    value="{{value.suggestion}}"
            {% endif %}
            >

            <select class="w3-select w3-border" id="category" name="category">
                <option class="selectCategory" value="default" disabled selected>categorie recept</option>
                {% for category in categories %}
                    <option class="selectCategory" value="{{category.name}}"
                    {% if mode == "update" %}
                        {% if category.name == value.category.name %}
                            selected
                        {% endif %}
                    {% endif %}
                    >{{category.name}}</option>
                {% endfor %}
            </select>

            <select class="w3-select w3-border" id="type" name="type">
                <option class="selectType" value="default" disabled selected>type recept</option>
                {% for type in types %}
                    <option class="selectType" value="{{type.name}}"
                    {% if mode == "update" %}
                        {% if type.name == value.type.name %}
                            selected
                        {% endif %}
                    {% endif %}
                    >{{type.name}}</option>
                {% endfor %}
            </select>

            <input type="number" id="numberOfEaters"
                {% if mode == "update" %}
                    value={{nrOfEaters}}
                {% endif %}
            ><label for="numberOfEaters">eters
            </label>

        </div>

        {# create the boxes to select an ingredient #}
        <div class="w3-card step ingredients">
            <h3>kies je ingredienten</h3>
            <input type="text" id="searchForIngredients" class="w3-input" placeholder="zoek naar ingredienten">
            <br>
            <p>
                <label class="switch ingredients">
                    <input type="checkbox">
                    <span class="slider"></span>
                </label>
                toon enkel geselecteerde ingredienten
            </p>

            <div class="scrollbox">
            {% for ingredient in ingredients %}
                {% set added = false %}
                {% set quantity = 0 %}
                {% if mode == "update" %}
                    {% for checkedIngr in value.ingredients %}
                        {% if ingredient.name == checkedIngr.ingredient.name %}
                            {% set added = true %}
                            {% set quantity = checkedIngr.quantity*nrOfEaters %}
                        {% endif %}
                    {% endfor %}
                {% endif %}

                <div class="oneIngredient ingredient{{ingredient.id}}">
                    <input class="w3-check ingredients" type="checkbox" name="ingredients" value="ingredient{{ingredient.id}}"
                    {% if added %}
                        checked
                    {% endif %}
                    />
                    <label for="unit-ingredient{{ingredient.id}}">
                    <input type="number" step="0.01" name="unit-ingredient{{ingredient.id}}"
                    {% if added %}
                        value={{quantity}}
                    {% else %}
                        disabled
                    {% endif %}
                    />
                    {{ingredient.unit.name}}</label>
                    <label for="ingredient{{ingredient.id}}">{{ingredient.name}}</label>
                </div>
            {% endfor %}
            </div>

        </div>

        <div class="w3-card step herbs">
            <h3>kies je kruiden</h3>
            <input type="text" id="searchForHerbs" class="w3-input" placeholder="zoek naar kruiden">
            <br>
            <p>
                <label class="switch herbs">
                    <input type="checkbox">
                    <span class="slider"></span>
                </label>
                toon enkel geselecteerde kruiden
            </p>
            
            <div class="scrollbox">
            {% for herb in herbs %}
                {% set added = false %}
                {% if mode == "update" %}
                    {% for checkedHerb in value.recipeHerb %}
                        {% if herb.name == checkedHerb.herb.name %}
                            {% set added = true %}
                        {% endif %}
                    {% endfor %}
                {% endif %}

                <div class="oneHerb herb{{herb.id}}">
                    <input class="w3-check herbs" type="checkbox" name="herbs" value="herb{{herb.id}}"
                    {% if added %}
                        checked
                    {% endif %}
                    />
                    <label for="herb{{herb.id}}">{{herb.name}}</label>
                </div>
            {% endfor %}
            </div>
        </div>

        <div class="w3-card step recipe">
            <h3><label for="recipe">bereidingswijze</label></h3>
            <textarea name="recipe" cols="30" rows="10">{% if mode == "update" %}{{value.instructions}}{% endif %}
            </textarea>
        </div>

            <!-- confirmation and errors -->
            <div class="w3-card step recipe">
                <button class="confirm">
                    {% if mode == "update" %}
                        Pas dit recept aan
                    {% else %}
                        Sla dit recept op
                    {% endif %}
                </button>
                <ul class="errors"></ul>
                <ul class="success"></ul>
            </div>
    </div>
    </div>
{% endblock %}

{% block javascripts %}
    {{ parent() }}
    {% if mode == "update" %}
    <script>
        var mode = "{{mode}}";
        var slug = "{{value.name}}";
    </script>
     <script src="{{ asset('js/updateRecipe.js') }}"></script>

    {% else %}
        <script src="{{ asset('js/addRecipe.js') }}"></script>

    {% endif %}
    {# <script src="{{ asset('js/addRecipe.js') }}"></script> #}
{% endblock %}
